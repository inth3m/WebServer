[TOC]
# 知识点

## eventfd
eventfd是一个用来通知事件的文件描述符
只有一个系统调用

```C
int eventfd(unsigned int initval, int flags);
```

创建一个eventfd对象,该对象是一个内核维护的无符号的64位整型计数器。初始化为initval的值。

flags是三个标志位OR的结果
-  EFD_CLOEXEC：FD_CLOEXEC，简单说就是fork子进程时不继承，对于多线程的程序设上这个值不会有错的。
- EFD_NONBLOCK：文件会被设置成O_NONBLOCK，一般要设置。
- EFD_SEMAPHORE：（2.6.30以后支持）支持semophore语义的read，简单说就值递减1。EFD_SEMAPHORE：（2.6.30以后支持）支持semophore语义的read，简单说就值递减1。

这个新建的fd的操作很简单：

read(): 读操作就是将counter值置0，如果是semophore就减1。

write(): 设置counter的值。

注意，还支持epoll/poll/select操作，当然，以及每种fd都都必须实现的close。

